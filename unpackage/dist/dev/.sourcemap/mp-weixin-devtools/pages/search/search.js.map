{"version":3,"names":["queryParams","common_vendor","ref","pageNum","pageSize","keyword","historySearch","index","getStorageSync","recommendList","noData","classList","onSearch","value","_toConsumableArray2","Set","concat","setStorageSync","searchWall","onClear","clickTab","removeHistory","showModal","title","success","res2","confirm","removeStorageSync","onReachBottom","onUnload","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","result","wrap","_callee$","_context","prev","next","api_apis","apiSearchWall","sent","data","res","length","__f__","stop","apply","arguments","wx","createPage","MiniProgramPage"],"sources":["search.vue","cGFnZXMvc2VhcmNoL3NlYXJjaC52dWU"],"sourcesContent":["<template>\n\t<view class=\"searchLayout\">\n\t\t<view class=\"search\">\n\t\t\t<uni-search-bar \n\t\t\t@confirm=\"onSearch\"\n\t\t\t@cancel=\"onClear\"\n\t\t\t@clear=\"onClear\"\n\t\t\tfocus \n\t\t\tplaceholder=\"搜索\"\n\t\t\tv-model=\"queryParams.keyword\">\n\t\t\t</uni-search-bar>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view>\n\t\t\t<view class=\"history\" v-if=\"historySearch.length\">\n\t\t\t\t<view class=\"topTitle\">\n\t\t\t\t\t<view class=\"text\">最近搜索</view>\n\t\t\t\t\t<view class=\"icon\" @click=\"removeHistory\">\n\t\t\t\t\t\t<uni-icons type=\"trash\" size=\"25\"></uni-icons>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"tabs\">\n\t\t\t\t\t<view class=\"tab\" v-for=\"tab in historySearch\" :key=\"tab\" @click=\"clickTab(tab)\">{{tab}}</view>\t\t\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"recommend\">\n\t\t\t\t<view class=\"topTitle\">\n\t\t\t\t\t<view class=\"text\">热门搜索</view>\t\t\t\t\n\t\t\t\t</view>\n\t\t\t\t<view class=\"tabs\">\t\t\t\t\n\t\t\t\t\t<view class=\"tab\" v-for=\"tab in recommendList\" :key=\"tab\" @click=\"clickTab(tab)\">{{tab}}</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view class=\"noSearch\">\n\t\t\t<uv-empty mode=\"search\" icon=\"http://cdn.uviewui.com/uview/empty/search.png\"></uv-empty>\n\t\t</view>\n\t\t\n\t\t\n\t\t<view>\n\t\t\t<view class=\"list\">\n\t\t\t\t<navigator :url=\"`/pages/preview/preview`\"  class=\"item\" \n\t\t\t\tv-for=\"item in classList\" :key=\"item._id\">\t\t\t\t\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\t\t\t\t\n\t\t\t\t</navigator>\n\t\t\t</view>\t\t\n\t\t\t<view v-if=\"noData || classList.length\"><uni-load-more :status=\"noData?'noMore':'loading'\"/></view>\n\t\t</view>\n\t\t<view class=\"safe-area-inset-bottom\"></view>\n\t\t\n\t</view>\n</template>\n\n<script setup>\nimport {ref} from \"vue\";\nimport {onLoad,onUnload,onReachBottom} from \"@dcloudio/uni-app\";\nimport {apiSearchWall} from '@/api/apis.js'\n//查询参数\nconst queryParams = ref({\t\n\tpageNum:1,\n\tpageSize:12,\n\tkeyword:\"\"\n})\n\n//搜索历史词\nconst historySearch = ref(uni.getStorageSync('historySearch') || []);\n\n//热门搜索词\nconst recommendList = ref([\"美女\",\"帅哥\",\"宠物\",\"卡通\"]);\n\n//没有更多\nconst noData = ref(false);\n//没有搜索结果\nconst noSearch = ref(false);\n\n//搜索结果列表\nconst classList = ref([]);\n\n\n//点击搜索\nconst onSearch = ()=>{\n\thistorySearch.value = [...new Set([queryParams.value.keyword,...historySearch.value])]\r\n\tuni.setStorageSync('historySearch',historySearch.value)\r\n\tsearchWall()\n}\n\n//点击清除按钮\nconst onClear = ()=>{\n\t\n}\n\n\n\n//点击标签进行搜索\nconst clickTab = (value)=>{\n\tqueryParams.value.keyword = value\r\n\tsearchWall()\n}\n\n\n//点击清空搜索记录\nconst removeHistory = ()=>{\n\tuni.showModal({\n\t\ttitle:\"是否清空历史搜索？\",\n\t\tsuccess:res=>{\n\t\t\tif(res.confirm){\r\n\t\t\t\tuni.removeStorageSync('historySearch')\r\n\t\t\t\thistorySearch.value = []\n\t\t\t}\n\t\t}\n\t})\n}\n\n//触底加载更多\nonReachBottom(()=>{\n\tqueryParams.value.pageNum++;\r\n\tsearchWall()\n})\n\n//关闭有页面\nonUnload(()=>{\n\t\n})\n\n\r\n// 搜索\r\nconst searchWall = async() =>{\r\n\tlet result = await apiSearchWall(queryParams.value)\r\n\tclassList.value = [...classList.value,...result.data]\r\n\tif(queryParams.value.pageSize != res.data.length) noData.value = true\r\n\tconsole.log(result);\r\n}\r\n\n</script>\n\n<style lang=\"scss\" scoped>\n.searchLayout{\n\t.search{\n\t\tpadding:0 10rpx;\n\t}\n\t.topTitle{\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tfont-size: 32rpx;\n\t\tcolor:#999;\n\t}\n\t.history{\n\t\tpadding:30rpx;\t\t\n\t}\n\t.recommend{\n\t\tpadding:30rpx;\n\t}\n\t.tabs{\n\t\tdisplay: flex;\t\t\n\t\talign-items: center;\n\t\tflex-wrap: wrap;\n\t\tpadding-top:20rpx;\n\t\t.tab{\n\t\t\tbackground: #F4F4F4;\n\t\t\tfont-size: 28rpx;\n\t\t\tcolor:#333;\n\t\t\tpadding:10rpx 28rpx;\n\t\t\tborder-radius: 50rpx;\n\t\t\tmargin-right: 20rpx;\n\t\t\tmargin-top: 20rpx;\n\t\t}\n\t}\t\n\t.list{\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(3,1fr);\n\t\tgap: 5rpx;\n\t\tpadding:20rpx 5rpx;\t\t\n\t\t.item{\n\t\t\theight: 440rpx;\n\t\t\timage{\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\t\t\t\n\t\t}\t\t\n\t}\n}\n</style>\n","import MiniProgramPage from 'D:/前端学习/前端项目/wallpaper/pages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}