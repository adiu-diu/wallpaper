{"version":3,"file":"classlist.js","sources":["pages/classlist/classlist.vue","../../../HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3NsaXN0L2NsYXNzbGlzdC52dWU"],"sourcesContent":["<template>\n\t<view class=\"classlist\">\r\n\t\t<!-- 加载组件:在初始页面加载且有数据可请求到时显示 -->\r\n\t\t<view class=\"loadingLayout\" v-if=\"!wallList.length && !noData\">\r\n\t\t\t<uni-load-more status=\"loading\"></uni-load-more>\r\n\t\t</view>\n\t\t<view class=\"content\">\r\n\t\t\t<navigator :url=\"`/pages/preview/preview?id=${item._id}`\" class=\"item\" v-for=\"item in wallList\" :key=\"item._id\">\r\n\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\"></image>\r\n\t\t\t</navigator>\r\n\t\t</view>\r\n\t\t<!-- 加载组件:初始页面加载时不显示 -->\r\n\t\t<view class=\"loadingLayout\" v-if=\"wallList.length\">\r\n\t\t\t<uni-load-more :status=\"noData ? 'noMore':'loading'\"></uni-load-more>\r\n\t\t</view>\r\n\t\t<!-- 小程序底部安全区域(home键) -->\r\n\t\t<view class=\"safe-area-inset-bottom\"></view>\n\t</view>\n</template>\n\n<script setup>\nimport {ref,onMounted} from 'vue'\r\nimport {apiGetWallList,apiUserWallList} from '@/api/apis.js'\r\nimport { onLoad,onUnload,onShareAppMessage,onShareTimeline,onReachBottom} from '@dcloudio/uni-app'\r\nimport {goHome} from '@/utils/common.js'\r\n// 存储当前图片列表数据\r\nconst wallList = ref([])\r\n// 定义当前是否需要跳过这次请求发送\r\nconst noData = ref(false)\r\n// 获取图片列表的参数信息\r\nconst queryParams = ref({\r\n\tpageNum:1,   // 记录当前获取到哪一页的数据\r\n\tpageSize:12\r\n})\r\nconst pageName = ref()\r\n// 获取当前图片列表数据\r\nconst getWallList = async(data) =>{\r\n\tlet result\r\n\t// 若是通过 我的下载 或者 我的评分 点击进入的此页面\r\n\tif(queryParams.value.type) result = await apiUserWallList(data)\r\n\telse result = await apiGetWallList(data)\r\n\t// 将新获取到的数据和先前的数据做一个整合\r\n\twallList.value = [...wallList.value,...result.data]\r\n\tif(result.data.length !== queryParams.value.pageSize){\r\n\t\tnoData.value = true\r\n\t}\r\n\tuni.setStorageSync('picList',wallList.value)\r\n}\r\n// 使用onLoad生命周期钩子来获取页面传递的参数\r\nonLoad((e)=>{\r\n\tlet {id=null,name=null,type=null} = e;\r\n\t// 通过 我的下载 或者 我的评分 点击进入的此页面   整合参数向apiUserWallList发送请求\r\n\tif(type) queryParams.value.type = type;\r\n\tconsole.log(id,type);\r\n\t// 通过分享进入的此页面，则没有id也没有type类型\r\n\tif(!id && !type) goHome()\r\n\tpageName.value = name\r\n\tqueryParams.value.classid = id\r\n\tuni.setNavigationBarTitle({\r\n\t\ttitle:name\r\n\t})\r\n})\r\n// 触底回调\r\nonReachBottom(()=>{\r\n\tif(noData.value) return;\r\n\tqueryParams.value.pageNum++;\r\n\tgetWallList(queryParams.value)\r\n})\r\n// 在组件挂载后发送请求\r\nonMounted(()=>{\r\n\tgetWallList(queryParams.value)\r\n})\r\n\r\n// 分享给好友\nonShareAppMessage(()=>{\n\treturn {\n\t\ttitle:`adiu-${pageName.value}`,\n\t\tpath:`/pages/classlist/classlist?id=${queryParams.value.classid}&name=${pageName.value}`\n\t}\n})\n// 分享到朋友圈\nonShareTimeline(()=>{\n\treturn {\n\t\ttitle:\"adiu\",\r\n\t\tquery:`id=${queryParams.value.classid}&name=${pageName.value}`\n\t}\n})\r\n// 离开页面时删除本地存储中的列表\r\nonUnload(()=>{\r\n\tuni.removeStorageSync('picList')\r\n})\n</script>\n\n<style lang=\"scss\" scoped>\r\n@import url('@/common/style/common-style.scss');\n.classlist{\r\n\t.content{\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgap: 5rpx;\r\n\t\tpadding: 5rpx;\r\n\t\t.item{\r\n\t\t\theight: 440rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth:100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}       \n</style>\n","import MiniProgramPage from 'D:/前端学习/前端项目/wallpaper/pages/classlist/classlist.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","apiUserWallList","apiGetWallList","uni","onLoad","goHome","onReachBottom","onMounted","onShareAppMessage","onShareTimeline","onUnload"],"mappings":";;;;;;;;;;;;;;;AA0BA,UAAA,WAAAA,cAAA,IAAA,EAAA;AAEA,UAAA,SAAAA,cAAA,IAAA,KAAA;AAEA,UAAA,cAAAA,cAAAA,IAAA;AAAA,MACA,SAAA;AAAA;AAAA,MACA,UAAA;AAAA,IACA,CAAA;AACA,UAAA,WAAAA,cAAAA,IAAA;AAEA,UAAA,cAAA,OAAA,SAAA;AACA,UAAA;AAEA,UAAA,YAAA,MAAA;AAAA,iBAAA,MAAAC,SAAA,gBAAA,IAAA;AAAA;AACA,iBAAA,MAAAC,SAAA,eAAA,IAAA;AAEA,eAAA,QAAA,CAAA,GAAA,SAAA,OAAA,GAAA,OAAA,IAAA;AACA,UAAA,OAAA,KAAA,WAAA,YAAA,MAAA,UAAA;AACA,eAAA,QAAA;AAAA,MACA;AACAC,oBAAAA,MAAA,eAAA,WAAA,SAAA,KAAA;AAAA,IACA;AAEAC,kBAAA,OAAA,CAAA,MAAA;AACA,UAAA,EAAA,KAAA,MAAA,OAAA,MAAA,OAAA,KAAA,IAAA;AAEA,UAAA;AAAA,oBAAA,MAAA,OAAA;AACAD,oBAAA,MAAA,MAAA,OAAA,uCAAA,IAAA,IAAA;AAEA,UAAA,CAAA,MAAA,CAAA;AAAAE,4BAAA;AACA,eAAA,QAAA;AACA,kBAAA,MAAA,UAAA;AACAF,oBAAAA,MAAA,sBAAA;AAAA,QACA,OAAA;AAAA,MACA,CAAA;AAAA,IACA,CAAA;AAEAG,kBAAAA,cAAA,MAAA;AACA,UAAA,OAAA;AAAA;AACA,kBAAA,MAAA;AACA,kBAAA,YAAA,KAAA;AAAA,IACA,CAAA;AAEAC,kBAAAA,UAAA,MAAA;AACA,kBAAA,YAAA,KAAA;AAAA,IACA,CAAA;AAGAC,kBAAAA,kBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA,QAAA,SAAA,KAAA;AAAA,QACA,MAAA,iCAAA,YAAA,MAAA,OAAA,SAAA,SAAA,KAAA;AAAA,MACA;AAAA,IACA,CAAA;AAEAC,kBAAAA,gBAAA,MAAA;AACA,aAAA;AAAA,QACA,OAAA;AAAA,QACA,OAAA,MAAA,YAAA,MAAA,OAAA,SAAA,SAAA,KAAA;AAAA,MACA;AAAA,IACA,CAAA;AAEAC,kBAAAA,SAAA,MAAA;AACAP,oBAAA,MAAA,kBAAA,SAAA;AAAA,IACA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzFA,GAAG,WAAW,eAAe;"}